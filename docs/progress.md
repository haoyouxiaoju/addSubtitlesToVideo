# 项目进度文档 (Project Progress)

## 📅 更新日志

### 2026-01-02 (Latest)
- **功能增强**:
  - 优化输出目录结构，新增 `Extra/output` 文件夹用于存放中间产物（字幕、音频）。
  - 新增 UI 选项 "导出字幕文本" 和 "导出音频文件"，用户可自定义是否保留这些文件。
  - 优化 QProcess 进程管理，实现进程复用，避免频繁销毁创建带来的开销。
- **Bug 修复**:
  - 修复了多任务处理时可能的资源竞争问题。
- **文档更新**:
  - 更新技术规格说明书，反映新的文件输出结构和 UI 配置项。

### 2026-01-01
- **功能增强**:
  - 添加了 FFmpeg 操作（音频提取、字幕合成）的实时进度显示，实现了全流程可视化。
  - 优化了 C++ 对 FFmpeg `stderr` 的解析逻辑，支持 `\r` 刷新行的解析。
  - 完善了界面文案，不再固定显示 "Vosk"，而是动态反映当前引擎。
- **Bug 修复**:
  - 修复了 GPU (Whisper) 在部分显卡上使用 FP16 精度导致乱码或崩溃的问题，统一强制使用 `int8_float32` 计算类型。
  - 修复了 FFmpeg 进度条无法解析导致 UI 假死的问题。
  - 修复了程序关闭后 Python 后台进程未退出导致显存不释放的问题 (通过重写 closeEvent 强制终止子进程)。
  - 修复了 FFmpeg 处理中文路径时的乱码问题 (使用 `QDir::toNativeSeparators` 和正确的路径转义)。
- **文档更新**:
  - 更新 `README.md`，添加一键编译脚本说明和常见问题解答。
  - 新增 `INTERFACE.md`，规范前后端通信协议。
  - 新增 `PROGRESS.md`，记录项目迭代历史。

### 早期版本
- **核心功能**:
  - 完成 Qt 6.9 基础界面搭建 (拖拽支持、多任务队列)。
  - 集成 Vosk (离线) 和 Faster-Whisper (GPU) 双引擎。
  - 实现视频转音频 -> 语音识别 -> 字幕合成的全自动化流程。
- **架构设计**:
  - 采用 C++ (UI/调度) + Python (AI推理) + FFmpeg (媒体处理) 的混合架构。
  - 实现了基于 QProcess 的外部进程管理和日志捕获。

## 📝 待办事项 (Todo)
- [ ] **多语言支持**: 目前强制中文，未来可支持英文、日文等。
- [ ] **字幕编辑**: 在合成前提供简易的字幕编辑界面。
- [ ] **模型管理**: 提供 GUI 界面管理已下载的模型文件（删除/手动导入）。
- [ ] **打包发布**: 制作安装包 (Installer)，集成 Python 嵌入式环境，实现开箱即用。
